{% load wagtailimages_tags %}

<div class="event-list columns is-multiline is-desktop">
    {% if events %}
                
            {% for event in events %}
                <style>
                    /* Hide the checkbox itself visually */
                    .card .card-content .toggle-checkbox-{{ event.web_id }} {
                        display: none;
                    }
                    /* When the checkbox is checked, and its immediate sibling (.btn-info) is present,
                       then any subsequent sibling (.card-abstract) will be displayed. */
                    .card .card-content .toggle-checkbox-{{ event.web_id }}:checked + .btn-info ~ .card-abstract {
                        display: block;
                    }
                    
                </style>  
                <div class="column is-multiline is-full">
                    <div class="card">
                        <div class="card-header columns {{ event.warning_class }}">
                            {% if event.status %}
                                <span class="column is-text-col">{{ event.status|upper }}! </span>
                            {% endif %}
                            <span class="column is-text-col">{{ event.event_type }}</span>
                        </div>
                        <div class="card-content">
                            <div class="columns">                
                                <div class="column is-half is-text-col {{ event.cancelled|yesno:"strikethrough," }}">
                                    <p class="card-title">{{ event.start_time|date:"D" }} 
                                        {{ event.start_time|date:"d.m, H:i" }} Uhr</p>
                                    <p class="card-subtitle"><b>{{ event.event_title }}</b><br>{{ event.referent }}</p>
                                </div>                          
                                {% if event.image %}
                                    <div class="column is-half is-image-col">
                                        {% image event.image original class="is-fullwidth card-image-wrapper" %}
                                    </div>
                                {% endif %}
                            </div>                        
                            <label for="toggle-info-{{ event.web_id }}" class="btn btn-info">Info</label>
                            <input type="checkbox" id="toggle-info-{{ event.web_id }}" class="toggle-checkbox-{{ event.web_id }}">
                            {% if event.status %}
                                <b>{{ event.status|upper }}!</b>
                            {% elif event.needs_reservation %}
                                {% if event.is_reservable %}
                                    <a href="{{ event.reservation_mailto_link }}" class="btn btn-reservation">Reservierung</a>
                                {% else %}
                                    Reservierbar ab dem {{ event.first_reservation_date|date:"d.m" }}
                                {% endif %}
                            {% else %}
                                Keine Reservierung erforderlich
                            {% endif %}
                            <div class="card-abstract">
                                <p>{{ event.abstract|striptags }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
    {% else %}
        <p>Keine Veranstaltungen geplant</p>
    {% endif %}
</div>
